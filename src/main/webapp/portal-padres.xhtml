<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="jakarta.faces.html"
      xmlns:f="jakarta.faces.core"
      xmlns:p="primefaces">

<h:head>
    <title>Portal de Padres</title>
    <link rel="stylesheet" href="css/style.css"/>
</h:head>

<h:body style="background: var(--surface-100)">

    <f:metadata>
        <f:viewAction action="#{LoginBean.evitarCache()}" />
        <f:viewAction action="#{LoginBean.verificarSesionPortalPadres()}" />
    </f:metadata>

    <div class="navbar" style="background: #1e1e1e; display: flex; place-content: space-between; padding: 1.5rem">
        <h1><i class="pi pi-book" style="font-size: 1.7rem; margin-right: 0.5rem"></i>Studify</h1>

        <h:form>
            <p:commandButton action="#{LoginBean.logout()}" style="font-weight: bold; pointer-events: all;" value="Salir"/>
        </h:form>
    </div>

    <div class="table-container table-cal" style="padding-top: 0; margin-top: -1rem">
        <h:form>
            <p:dataTable var="calificacion" value="#{CalificacionesBean.calificaciones}"  emptyMessage="No hay calififcaciones disponibles.">

                <f:facet name="header">
                    <span>Lista de Calificaciones</span>
                </f:facet>

                <p:column headerText="Año" sortBy="#{calificacion.id_estudiante}" filterBy="#{calificacion.id_estudiante}">
                    <h:outputText value="#{calificacion.anio}" />
                </p:column>

                <p:column headerText="Período" sortOrder="#{calificacion.segundo_parcial}" filterBy="#{calificacion.segundo_parcial}">
                    <h:outputText value="#{calificacion.periodo}" />
                </p:column>


                <p:column headerText="" >

                    <p:commandButton icon="pi pi-eye" update=":dialogs:manage-calificacion-content"
                                     oncomplete="PF('manageCalificacionDialog').show()"
                                     styleClass="edit-button rounded-button ui-button-success" process="@this" value="Ver">
                        <f:setPropertyActionListener value="#{calificacion}" target="#{CalificacionesBean.selectedCalificacion}" />
                        <p:resetInput target=":dialogs:manage-calificacion-content" />
                    </p:commandButton>

                </p:column>

            </p:dataTable>
        </h:form>
    </div>

    <h:form id="dialogs" style="width: 60%">
        <p:dialog header="Calificaciones" showEffect="fade" modal="true" widgetVar="manageCalificacionDialog"
                  responsive="true" style="max-width: 700px">

            <p:outputPanel id="manage-calificacion-content" class="ui-fluid">

                <div class="card dialog-cal">
                    <h:form>
                        <p:dataTable var="calificacion" value="#{CalificacionesBean.selectedCalificacion}"  emptyMessage="No hay calififcaciones disponibles.">

                            <p:column headerText="Materia">
                                <h:outputText value="#{MateriasBean.mostrarNombreMateria(calificacion.id_materia)}"/>
                            </p:column>

                            <p:column headerText="1P">
                                <h:outputText value="#{calificacion.primer_parcial}" />
                            </p:column>

                            <p:column headerText="2P">
                                <h:outputText value="#{calificacion.segundo_parcial}" />
                            </p:column>

                            <p:column headerText="3P" >
                                <h:outputText value="#{calificacion.tercer_parcial}" />
                            </p:column>

                        </p:dataTable>

                        <div class="details">
                            <p:dataTable var="calificacion" value="#{CalificacionesBean.selectedCalificacion}"  emptyMessage="No hay calififcaciones disponibles.">
                                <p:column headerText="Observación" >
                                    <h:outputText value="#{calificacion.observacion}" />
                                </p:column>
                            </p:dataTable>
                        </div>

                    </h:form>
                </div>
            </p:outputPanel>
        </p:dialog>
    </h:form>


    <script src="js/main.js" type=""></script>
</h:body>
</html>
